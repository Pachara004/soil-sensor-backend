# üë§ User Management Endpoints

## üîß **Endpoints ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ**

### **1. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ (Profile Update)**
```
PUT /api/users/:id
```

**Request Body:**
```json
{
  "user_name": "new_username",
  "user_phone": "081-234-5678",
  "user_email": "newemail@example.com"
}
```

**Response:**
```json
{
  "message": "User updated successfully",
  "user": {
    "userid": 7,
    "user_name": "new_username",
    "user_email": "newemail@example.com",
    "user_phone": "081-234-5678",
    "role": "user",
    "firebase_uid": "Q1rUo1J8oigi6JSQaItd3C09iwh1",
    "created_at": "2025-01-23T10:00:00.000Z",
    "updated_at": "2025-01-23T13:30:00.000Z"
  }
}
```

**Permissions:**
- **User:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- **Admin:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô

### **2. ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô (Change Password)**
```
PUT /api/users/:id/password
```

**Request Body:**
```json
{
  "currentPassword": "old_password",
  "newPassword": "new_password"
}
```

**Response:**
```json
{
  "message": "Password changed successfully"
}
```

**Permissions:**
- **User:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á‡πÑ‡∏î‡πâ (‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤)
- **Admin:** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏ï‡πâ‡∏≠‡∏á‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤)

### **3. ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô Role (Admin Only)**
```
PUT /api/users/:id/role
```

**Request Body:**
```json
{
  "role": "admin"
}
```

**Response:**
```json
{
  "message": "User role updated successfully",
  "user": {
    "userid": 7,
    "user_name": "username",
    "user_email": "email@example.com",
    "role": "admin"
  }
}
```

**Permissions:**
- **Admin Only:** ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ admin ‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô role ‡πÑ‡∏î‡πâ

## üîç **Endpoints ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ**

### **1. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Admin) ‡∏´‡∏£‡∏∑‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (User)**
```
GET /api/users
```

**Response (Admin):**
```json
{
  "users": [
    {
      "userid": 7,
      "user_name": "username",
      "user_email": "email@example.com",
      "user_phone": "081-234-5678",
      "role": "user",
      "firebase_uid": "Q1rUo1J8oigi6JSQaItd3C09iwh1",
      "created_at": "2025-01-23T10:00:00.000Z",
      "updated_at": "2025-01-23T13:30:00.000Z"
    }
  ]
}
```

**Response (User):**
```json
{
  "user": {
    "userid": 7,
    "user_name": "username",
    "user_email": "email@example.com",
    "user_phone": "081-234-5678",
    "role": "user",
    "firebase_uid": "Q1rUo1J8oigi6JSQaItd3C09iwh1",
    "created_at": "2025-01-23T10:00:00.000Z",
    "updated_at": "2025-01-23T13:30:00.000Z"
  }
}
```

### **2. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î (Admin Only)**
```
GET /api/users/all
```

### **3. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞ (Admin)**
```
GET /api/users/:id
```

### **4. ‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á (Alias)**
```
GET /api/users/profile
GET /api/users/me
```

## üõ°Ô∏è **Security Features**

### **1. Authentication Required**
- ‡∏ó‡∏∏‡∏Å endpoint ‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ JWT token
- ‡πÉ‡∏ä‡πâ `authMiddleware` ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö

### **2. Authorization**
- **User:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á
- **Admin:** ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡πÑ‡∏î‡πâ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô

### **3. Validation**
- **Username:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
- **Email:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡πÑ‡∏°‡πà‡∏ã‡πâ‡∏≥
- **Password:** ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 6 ‡∏ï‡∏±‡∏ß‡∏≠‡∏±‡∏Å‡∏©‡∏£
- **Current Password:** ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏Å‡πà‡∏≤

### **4. Error Handling**
- **400:** Bad Request (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏°‡πà‡∏Ñ‡∏£‡∏ö)
- **401:** Unauthorized (‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏¥‡∏î)
- **403:** Forbidden (‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå)
- **404:** Not Found (‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ)
- **409:** Conflict (‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ã‡πâ‡∏≥)
- **500:** Internal Server Error

## üìã **‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô**

### **1. User ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á:**
```bash
curl -X PUT http://localhost:3000/api/users/7 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "user_name": "new_username",
    "user_phone": "081-234-5678"
  }'
```

### **2. User ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô:**
```bash
curl -X PUT http://localhost:3000/api/users/7/password \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer YOUR_JWT_TOKEN" \
  -d '{
    "currentPassword": "old_password",
    "newPassword": "new_password"
  }'
```

### **3. Admin ‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô:**
```bash
curl -X PUT http://localhost:3000/api/users/7 \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN" \
  -d '{
    "user_name": "admin_updated_username",
    "user_email": "newemail@example.com"
  }'
```

### **4. Admin ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏Ñ‡∏ô‡∏≠‡∏∑‡πà‡∏ô:**
```bash
curl -X PUT http://localhost:3000/api/users/7/password \
  -H "Content-Type: application/json" \
  -H "Authorization: Bearer ADMIN_JWT_TOKEN" \
  -d '{
    "newPassword": "admin_set_password"
  }'
```

## üéØ **Console Logs**

### **Update User:**
```
üë§ Update user request: {id: '7', user_name: 'new_username', user_phone: '081-234-5678', requester: 7, role: 'user'}
‚úÖ User updated successfully: {userid: 7, user_name: 'new_username', ...}
```

### **Change Password:**
```
üîê Change password request: {id: '7', requester: 7, role: 'user'}
‚úÖ Password changed successfully for user: new_username
```

## üìö **‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£‡∏ó‡∏µ‡πà‡∏™‡∏£‡πâ‡∏≤‡∏á:**
- `docs/user-management-endpoints.md` - User Management Endpoints

**‡∏ï‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏û‡∏£‡πâ‡∏≠‡∏°‡πÅ‡∏•‡πâ‡∏ß! ‡∏°‡∏µ endpoints ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡πÅ‡∏Å‡πâ‡πÑ‡∏Ç‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏ó‡∏±‡πâ‡∏á admin ‡πÅ‡∏•‡∏∞ user** üîß‚ú®
